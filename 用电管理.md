# 摘要

​	用电管理数据系统是一个本地开发应用的独立应用系统。我在这个系统中使用了C++编程和MFC开发。其开发主要包括文件系统建立和维护以及MFC应用程序的开发两个方面。对于前者，要求建立一个数据一致性的文件管理。对于后者，要求应用功能安全完整，界面美观，操作方便。用电管理数据系统是针对目前麻烦的电费管理而设计的一款管理软件。是一个实用的管理信息系统。用户员可以通过相应的模块对信息进行更新、查询。输入抄表数据。通过本设计的应用,可以加强用电信息的管理,减轻管理人员的工作量，提高工作效率。

**关键字: 用电数据;管理信息系统;MFC开发**

# 正文

## 任务内容

​	电力行业一直是关系国计民生的重要事业。当前，随着社会整体信息化水平的不断提高，电力系统信息化的不断建设和发展已成为自然发展的必然趋势。电力行业信息化建设项目不仅是电力行业自身发展的保障,更是一项能够与人民息息相关、利国利民的重大工程。在当代国家电力企业信息化建设过程中，行业决策者和信息化建设管理者需要关注许多重要问题。一个良好便捷的用电管理数据系统能够很好的帮助我们解决问题，争对现有的问题我们统计用电管理数据，要求能用菜单实现如下功能:

(1)输入每个电表的用户名，楼栋号，抄表日期，电表读数。 

(2)按作者的用电量，从高到低排出每个用户的总用电量。
(3)根据用户要求输出某用户某月 (从键盘输入用户名和月份)的总用电量。

(4)统计某楼 栋从某月到某月(从键盘输入)的总用电量.

​	对于数据的输入要求主要有两个方面，1. 从文件输入，对于系统录入的所有信息都保存在文件中，打开系统后能够自动读取文件信息并展示在系统上；2. 用户输入，能够满足用户添加数据进行展示并能够保存到文件中。

## 设计步骤

### 1. 技术可行设计

​	IT行业从业人员一般要求掌握计算机技术，有一定的软硬件基础，使用各种管理软件，熟悉IT产品。因为一些电力公司对员工素质的要求比较高，从管理层到下面的销售人员，都需要一定的电脑基础，所以新系统投入使用时，只需要进行少量的培训即可。雇员。并且使用方法基本上可以让系统运行流畅。因此对于开发我们采用最为流传使用的c++与MFC开发，对于系统的维护使用都十分便捷。

### 2. 运行环境设计

​	本系统基于Windows 平台。该系统是熟悉的操作系统，具有一般计算机知识的人可以轻松上手。整个电源管理系统采用最友好的交互界面，介绍一目了然，无需深入了解运行逻辑。

### 3. 需求分析与设计

​	在保证生产正常运行的同时,可以有效减少库存资金的占用。经过需求调研，电力管理数据系统的主要职责是:

(1)输入每个电表的用户名，楼栋号，抄表日期，电表读数： 这一项需求要求系统能够提供用户输入的模块并能够将特定的数据保存下来以及展示在系统上。

(2)按作者的用电量，从高到低排出每个用户的总用电量：这一需求要求在第一点的基础上，我们不光要能够输入数据，还需要能够用很好的数据结构进行数据保存，并对保存数据进行合并整理以及排序输出展示。
(3)根据用户要求输出某用户某月 (从键盘输入用户名和月份)的总用电量：这一需求要求我们能够对数据信息进行整理并展示。

(4)统计某楼栋从某月到某月(从键盘输入)的总用电量：这一需求要求我们能够对数据信息进行整理并展示。

​	本系统的设计充分考虑了需求的不同因素,在多个不同的需求任务中进行保护设计,具有先进的安全性、通用性和操作方便。可有效实现用电信息管理和查询等功能。系统组成:系统数据读取、展示、保存，用户添加用电信息、查询用户用电信息、查询楼栋用电信息、用电信息排序展示。

## 采取的方法与手段

### 文件系统管理

​	我们采用csv文件进行数据管理保存，CSV文件是一种纯文本文件格式，用于存储表格数据（例如电子表格或数据库）。它的优点包括：简单易懂，数据兼容性好，资源占用低；CSV文件的结构相对简单，通常由以下组成：每行表示一条记录，逗号分隔每行数据中的不同数据。可以使用任何文本编辑器轻松打开和编辑，便于节省存储空间。同时，CSV文件中的数据可以很容易地跨平台进行传输和处理，任何具有CSV处理功能的软件都能处理该类型的文件。

### 系统逻辑处理

​	我们使用C++语言进行开发，继承自C语言的优点：语言简洁、紧凑，使用方便、灵活；拥有丰富的运算符；生成的目标代码质量高，程序执行效率高；可移植性好等。支持面向对象的程序设计，具有封装、继承和多态等特性，使得程序设计更加灵活、可扩展和易于维护。支持泛型编程，可以实现代码重用和模块化。支持STL（标准模板库），提供了丰富的数据结构和算法。

​	在对于用电信息的管理中，我们就采用了简单的STL容器中的vector进行开发，该容器将数据和操作分离，数据由容器类别加以管理，操作则由可定制的算法定义，迭代器在两者之间充当“粘合剂”，以使算法可以和容器交互运作。具有高可重用性、高性能、高移植性、跨平台的优点。提供了丰富的数据结构和算法，可以实现代码重用和模块化。我们利用它支持动态扩容，可以自动调整大小，不需要手动管理内存。支持随机访问，可以通过下标或迭代器访问元素。提供了丰富的操作函数，如插入、删除、排序等，可以方便地操作数据。

### MFC开发

​	本次的界面开发使用的是MFC库进行开发，其生成程序小，执行代码效率高；提供了丰富的类库和操作函数，如窗口、对话框、控件、消息处理等，可以方便地操作数据； 支持面向对象编程，可以提高开发效率和代码重用性。

## 问题与解决

​	在本次实验中主要遇到一些c++编程方面的问题：

​	1、无法解析的外部符号。

​	如果引用了string等库，一定要检查是否在工程属性的链接器常规和输入一栏加入了lib文件目录。
​	还有c++工程如果要引用c源文件可以直接把.c后缀名改为.cpp。
​	2、xxx已经被否决

​	很多库都是经常更新的，在更新过程中api经常会变化，如果你在github等地方找到了一个用库的文件，你装的库由比他的新，那么就会遇到xxx已经被否决之类的错误。这时候直接去工程属性，c，c++常规里面把SDL检查改为否即可。如果不行只能去下载旧版本的库。因为我们做工程要的是最快速度解决问题，找旧版本的api在新版本的替代方法速度太慢。
​	3、无法从“void *”转换为“TRANSFORM ”。

​	这个情况容易发生在.c文件改名为.cpp文件以后。因为c语言允许void到其他类型指针的隐式转换，但是c++不允许。改为显式转换就行了。

​	4、错误 C1853 “x64\Release\xxx.pch”

​	预编译头文件来自编译器的早期版本，或者预编译头为 C++ 而在 C 中使用它(或相反)。错误原因：c++的工程必须使用.cpp源文件，c语言的工程必须使用.c源文件。

​	5、.xxxxx的左边必须有类，结构，联合。但是你右键找到定义会发现其实这个变量是一个结构体或类。
​	首先确保别用错箭头与点，->是指针指向其成员的运算符.是结构体的成员运算符。最大的区别是->前面放的是指针，而.前面跟的是结构体变量。其次如果你用的vs软件，这个错误是错误列表的第一个错误，很可能错误的地方和这一行完全没有关系，这个是由其他错误引发的连锁错误，要去错误列表右侧的输出选项卡找到第一个错误进行修改即可。我这次就是不同库的宏定义重复引发的连锁错误。

# 总结与体会

​	此次实践最大的感受是，知识只有用于实践，才能充分的发挥其强大的做用力，展现其生命力。这学期的通过《c++语言程序设计》的学习，虽然掌握了一些基础知识，但对类和对象的做用理解不是很充分，通过此次实践，让我看到了类和对象的强大功能。自学能力是人生一笔丰厚的财富。虽然在课堂上从老师那学到了一些关于此次程序设计的知识，但由于此次编程涉及知识较广，而且难度大，为了能够彻底的掌握各种编程所需知识和技巧，我观看了一些网上的教学视频并自学了《Visual c++开发实战宝典》的MFC相关内容，然后自己尝试写代码，并成功的完成了任务。
​	人生贵在坚持。由于代码自己写的，所以其中难免有错误，而且一开始的时候很多函数都有错误，但是不管有多大困难，我都从来不畏惧。

# 参考文献

1. 王敏，张俊，赵坤灿，代秀.基于MFC 的高校人事档案管理信息系统的设计与实现[J.昆明冶金高等专科学校学报，2009 (3) : 31-36。

2. 张银霞，耿蕊，李敬有。融合计算思维的“C++程序设计”案例教学实践。工业和信息化教育，2021，(11): 42-46。
3. 刘忠艳，末志君，张兴华，王光芒，李懿，高志军。微课在C++程序设计课程教学中的应用。高师理科学刊，2021，37 (03): 90-92+96。
4. 吴桂芹，杨晓燕。“讲练同步、任务驱动”模式在VisualC++教学中的应用.电脑知识与技术，2021,12 (28):148-149。