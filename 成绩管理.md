# 摘要

​	随着科技的逐步广泛应用，信息技术在管理中，管理信息系统在技术上已经逐渐成熟，学生成绩管理系统是现代管理的重要组成部分。管理是促进学生信用管理科学化、规范化的必要条件，高校都有着巨大的学生资源，对学生的成绩进行科学的管理是必要的。因此，开发学生成绩管理系统势在必行。利用VisualStudio，MFC库实现了一个学生成绩管理系统，可以提交成绩、排序和查询信息。该系统软件是对学生成绩管理的一个工具,非常容易被接受,它具有简单易学性,便于管理等功能。通过教务处和学生管理人员的沟通,即学校的硬件现状进行深入、充分的调查研究,发现并能良好的改善学生成绩管理的基础上,开发了此系统。

**关键词: 信息管理；学生成绩；MFC开发**

# 正文

## 任务内容

​	统计一个班(最多有 35人)的学生成绩，要求能实现如下功能: 

(1) 输入每个学生的学号和6门课程的成绩。

(2) 计算每个学生的平均分和总分。 

(3) 按总分从高到低排出名次，并按名次输出每个学生的情况，包括学号、各科成绩、平均分和总分。 

(4) 根据用户要求输出某门课程(从键盘输入课程号)成绩在 90分以上(含 90分)总分在前5名的学生情况，包括学号、各科成绩、平均分和总分。

## 设计步骤

### 设计分析

​	对于一个管理系统而言，主函数，函数以及成员函数是其重要组成部分。主函数的主要任务是确定所需调用函数，根据课程设计要求，该系统至少应该实现以下几种基本功能:输出研究生各类基本信息，删除所需的各类研究生相关信息，修改各类研究生相关信息，查找各类研究生相关信息，保存所输入的研究生相关信息。实现以上任何一种功能都必须要调用一个函数，而编写函数的目的是编写一个能实现某种功能的函数供主函数调用。根据面向对象的特点，函数可以调用类中的成员函数。这样主函数和函数以及成员函数之间就层次分明，关系清晰明了，避免过于繁长。不同的函数调用的成员函数是不尽相同的,大体上每个函数都有一个相对应的成员函数，这些成员函数都是共有函数，并且只被其对应函数仅且只调用一次。当然，每个函数不可能只调用一个成员函数。而成员函数是一个系统的灵魂所在，因为所有的处理过程的细节都在成员函数中完成的。编写成员函数实际上就是一个算法的实现。成员函数的设计包括两方面内容:成员函数算法的实现和成员函数过程的实现。有了这些重要的部分，一个程序也就具备了初步的条件，一个管理系统的模型就被建立了起来。

### 大致流程

​	对学生成绩进行收集和录入。先定义一个学生基类，录入学生的基本个人信息:学号， 各科成绩等。由学生基类派生出两类子类: 平均成绩以及总成绩。在学生个人基本信息录入成功后，再设计模块对平均成绩和总成绩信息进行收集，进行计分和成绩统计及计算平均分和各分段所占相应总体的成绩。在完成相应信息和成绩的录入后，再输出各学生的基本信息及成绩和各分段所占相应总体的成绩，在系统已经录入了学生的各个成绩的前提下，使用输出功能可以显示学生的所有信息及相应成绩的相关内容等等。在主界面可以选择插入、查询，排序等所需操作来继续进行系统的完善。然后在所有操作完成后对所记录的信息进行保存,方便在下次使用时直接对已录入并记录的信息进行查询或者其它相应操作。

### 功能设计

​	本系统主要用于对学生各类成绩进行信息收集和管理。通过本系统，可以将学生的个人基本信息和相应成绩输入到系统中，由系统对成绩进行相应各类计算和录入，再保存到相应文件中，实现信息的录入和记录，便于进行相关查询和相关管理操作。此程序可以实现:录入、添加信息，查询各类研究生信息，计算与统计各类研究生相关信息，排序各学生各学科成绩，并将所录入的信息保存至文件，在查询时可显示之前所录入的相关信息。

## 方法

#### 成绩信息存储

​	成绩信息存储的任务是根据具体计算机系统（和硬件等）的特点，为给定的成绩数据模型确定合理的存储结构和存取方法。所谓的“合理”主要有两个含义:一个是要使设计出的存储占用较少的存储空间，另一个对数据的操作具有尽可能高的速度。数据模型的物理结构设计大致包括:确定数据的存取方法、确定数据的存储结构。确定数据库的存取方法，就是确定建立哪些存储路径以实现快速存取数据库中的数据;确定数据库的存储结构主要指确定数据的存放位置和存储结构。本次实验采用CSV文件进行成绩数据的存储。CSV文件的结构相对简单，通常由以下组成：每行表示一条记录，逗号分隔每行数据中的不同数据。可以使用任何文本编辑器轻松打开和编辑，便于节省存储空间。同时，CSV文件中的数据可以很容易地跨平台进行传输和处理，任何具有CSV处理功能的软件都能处理该类型的文件。对于在Windows平台开发的程序可以很好的适配不同版本的系统。数据安全性更高。

### 业务逻辑方法

​	本次课程设计采用C++作为开发语言，该语言继承自C语言的优点：语言简洁、紧凑，使用方便、灵活；拥有丰富的运算符；生成的目标代码质量高，程序执行效率高；可移植性好等。支持面向对象的程序设计，具有封装、继承和多态等特性，使得程序设计更加灵活、可扩展和易于维护。支持泛型编程，可以实现代码重用和模块化。支持STL（标准模板库），提供了丰富的数据结构和算法。对于本次实验中，我们需要开发不同的类进行数据的管理，使用c++的高扩展性，可以帮助我们更好的进行开发，效率提升很大。此外c++更贴近于操作系统底层，采用c++语言做本地应用的开发，对于程序的反应速度有了明显的提升，改善用户的使用感。

### 界面开发方法

​	本次实验采用微软提供的MFC开发库，该开发库其生成程序小，执行代码效率高；提供了丰富的类库和操作函数，如窗口、对话框、控件、消息处理等，可以方便地操作数据； 支持面向对象编程，可以提高开发效率和代码重用性。通过与C++开发语言相结合，能够帮助我们更好的进行事务处理与开发，对于不同的任务可能采用相同或者相近的数据，可以通过继承等高效的开发方法进行复用，大大减少了编程复杂度。此外，MFC开发对于新手较为友好可以通过拖拽的方式生成相应的界面，使得开发更加方便。

## 问题与解决

问题一：IDD_DIALOG1是未声明的标识符。

解决办法：在该对话框类的头文件中添加：#include "resource.h"

问题二：error C2664: “atoi”: 不能将参数 1 从“CString”转换为“const char *"

解决办法：在vc6.0下用CString str;num = atoi(str);就可以顺利取到num；但是同样代码拿到vs2008就报错，error C2664: “atoi”: 不能将参数 1 从“CString”转换为“const char*”；于是把CString 强制转换为char*，num = atoi((LPSTR)(LPCTSTR)str);编译不报错，运行成功。但是后面发现，本来str="123"，num应该是123，结果却只是1，试了其他的都是只取最前面一位。后面百度中无意发现，原来是，vc6.0默认是ansi编码，所以atoi可以直接用，结果也正确；但是VS2008默认的编码方式是Unicode，Unicode下不能用atoi，而要使用_wtoi 也可以直接使用_ttoi，它在 ANSI 编码系统中被编译成atoi()，而在 Unicode 编码系统中编译成_wtoi()。或者把vs改成ansi编码也行。num = _ttoi(str);（_ttoi类似于_T，随着编码方式会改变）。

问题三：在单文档中屏蔽菜单。

解决办法：可以直接在BOOL CMainFrame::PreCreateWindow(CREATESTRUCT& cs)代码中添加如下代码：

RECT rect;
	::GetWindowRect(GetDesktopWindow()->m_hWnd, &rect);
	if (cs.hMenu != NULL)
	{
		cs.hMenu = NULL;
	}

问题四：在MFC中遇到以下问题，Debug中可编译通过，Release版本编译不通过的一般是字符集的问题。

解决办法：一般是将：项目属性->配置属性->常规->项目默认值 下的字符集 改为：使用多字节字符集 即可。

问题五：无法解析的外部符号 "public: __thiscall CvvImage::CvvImage(void)" (??0CvvImage……

 解决办法：工程右键-属性-链接器-常规-附加库目录：cxcore.lib cv.lib ml.lib cvaux.lib highgui.lib；工程右键-属性-链接器-输入-附加库目录（Debug下和Realize下都要）：cxcore.lib cv.lib ml.lib cvaux.lib highgui.lib

## 总结

​	起初做课程设计时，遇到了许多的问题，如类的定义、公有函数怎么去实现所要的结果等一系列的问题，刚开始觉得有点棘手，很多问题搞不懂，不过经过和同组同学的认真讨论以及仔细的阅读教材和相关参考文献，渐渐认识到问题本质，进而将问题解决，将课程设计比较成功的完成了。但在我的整个系统整体上功能有些不太健全，自己感觉系统有点冗长，部分程序需精简，而且程序界面也不太美观，没有设计一些美观的板块，还有很多不足和需要改进的地方。经过这几天苦心钻研，我觉得是一门很有趣的学科，它很好的发散了我们的思维，让个人的自主学习能力有了很大的飞跃，与此同时，课程设计也很好的锻炼了同学之间配合与协作，有很多不懂的地方可以一起钻研。

# 参考文献

1. 张银霞，耿蕊，李敬有。融合计算思维的“C++程序设计”案例教学实践。工业和信息化教育，2021，(11): 42-46。
2. 刘忠艳，末志君，张兴华，王光芒，李懿，高志军。微课在C++程序设计课程教学中的应用。高师理科学刊，2021，37 (03): 90-92+96。
3. 吴桂芹，杨晓燕。“讲练同步、任务驱动”模式在VisualC++教学中的应用.电脑知识与技术，2021,12 (28):148-149。
4. 苏小红.双语版C++程序设计.电子工业出版社, 2010.6。
5. 於肇鹏.C/C++语言中“&”运算符的用法.辽宁师专学报,2011,13(3):40-42。
6. 叶雯.C+中的函数参数传递机制.中国-东盟博览,2011,(7): 102。
7. Jeff Prosise著、MFC Windows程序设计、北京博彦科技发展有限公司译、北京:清华大学出版社、2007
8. 宋坤，李伟明，刘锐宁编著、MFC程序开发参考大全、北京:人民邮电出版社、2007



